<head>
  <!-- BootstrapのCSSファイルを読み込み -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css">
  <!-- LightboxのCSSとJavaScriptファイルを読み込み -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>

</head>


<div class="container">
  <div class="card mb-3">
    <div class="row g-0">
      <div class="col-md-3">
        <div class="card-body">
          <h2 class="card-title">User info</h2>
          <%= render 'public/customers/info', customer: @post.customer %>
        </div>
      </div>
      <div class="col-md-8 offset-md-1">
        <div class="card-body">
          <h2 class="card-title">Gears</h2>
          <div class="row align-items-center">
            <% if @post.images.attached? %>
              <div class="col-md-2 col-6">
                <%= link_to image_tag(@post.images[0].variant(resize: "100x100"), class: "card-img-top"), "#", "data-toggle": "modal", "data-target": "#imageModal" %>
                <div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-scrollable" role="document">
                    <div class="modal-content">
                      <div class="modal-body">
                        <% @post.images.each do |image| %>
                          <%= image_tag image.variant(resize_to_limit: [800, 800]), class: "img-fluid mb-3" %>
                        <% end %>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
            <% if @post.video.attached? %>
              <div class="col-md-4 col-12">
                <div class="ratio ratio-16x9">
                  <video width="100%" controls>
                    <source src="<%= url_for(@post.video) %>" type="<%= @post.video.content_type %>">
                  </video>
                </div>
              </div>
            <% end %>

            <div class="col-md-8">
              <h5 class="card-title"><%= link_to @post.title, public_post_path(@post) %></h5>
              <p class="card-text"><%= @post.introduction %></p>
              <p class="card-text">コメント数: <%= @post.post_comments.count %></p>
              <% if current_customer %>
                <div class="row">
                  <div class="col-md-6">
                    <div id="favorite-btn">
                      <%= render "favorites/btn", post: @post %>
                    </div>
                  </div>
                  <% if @post.customer == current_customer %>
                    <div class="col-md-6">
                      <div class="btn-group" role="group">
                        <%= link_to 'Edit', edit_public_post_path(@post), class: "btn btn-sm btn-success" %>
                        <%= link_to 'Destroy', public_post_path(@post), method: :delete, data: { confirm: '本当に消しますか？' }, class: "btn btn-sm btn-danger" %>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
          <% if current_customer %>
            <div id="comment">
              <%= render "public/post_comments/index", post: @post %>
            </div>
            <%= render "public/post_comments/form", post: @post, post_comment: @post_comment %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
